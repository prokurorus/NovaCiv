FILE_MAP  — структура проекта NovaCiv (novaciv.space)
Версия: 2025-11-29

Назначение файла
----------------
Этот файл — “карта” проекта для нас двоих.
Он помогает быстро вспомнить:
- какие директории и ключевые файлы существуют;
- за что отвечает каждая крупная часть;
- какие Netlify-функции и вспомогательные модули уже реализованы;
- что уже используется в бою, а что черновик.

При добавлении новых файлов:
- лучше всего сразу дописывать сюда краткое описание,
- чтобы в будущем не тратить время на повторное “распознавание” архитектуры.

Корень репозитория
------------------
/ (root)
- package.json, package-lock.json  — зависимости проекта (React, Vite, Firebase, Netlify functions и т.д.).
- vite.config.*                    — конфигурация Vite (сборка фронтенда).
- tsconfig.* / jsconfig.*          — настройки TypeScript / пути импорта.
- index.html                       — HTML-шаблон для SPA (точка входа Vite).
- netlify.toml                     — конфигурация Netlify:
  - build.command = "npm run build"
  - publish = "dist"
  - указание директории функций: netlify/functions
- README.md                        — общее описание проекта (публичное).
- FILE_MAP_NovaCiv.txt             — этот файл-карта.

Папка public/
-------------
- favicon, иконки, статические изображения.
- Могут лежать исходные версии картинок (андроид-барельеф и т.п.).

Папка netlify/
--------------
netlify/functions/*.js`)
- Используют:
  - OpenAI API (чат, TTS/ASR, аналитика новостей)
  - Firebase Realtime Database
  - Telegram Bot API
  - SendGrid API (email)
- Конкретные функции:
  - ai-domovoy.js          — ИИ-домовой для сайта (ответы на вопросы, работа с форумом и текстами NovaCiv).
  - ai-voice.js            — голосовой интерфейс (TTS/ASR) для домового и голосового помощника.
  - fetch-news.js          — забирает новости из внешних RSS/источников, анализирует через OpenAI и создаёт темы в разделе news форума.
  - news-cron.js           — берёт новые темы из раздела news форума и рассылает их по трём Telegram-каналам (RU/EN/DE), помечая отправленные темы.
  - domovoy-auto-post.js   — “философский автопост” Домового: при каждом запуске генерирует по одному посту для ru/en/de в духе Устава/Манифеста, сохраняет их в раздел news форума и отправляет в Telegram-каналы.
  - post-to-telegram.js    — отправляет один подготовленный текст в указанный Telegram-канал (используется формами и внутренними функциями).
  - send-email.js          — отправка писем с сайта через SendGrid (форма контакта и прочие уведомления).


Важно:
- все функции используют общие env-переменные:
  - FIREBASE_DB_URL
  - OPENAI_API_KEY, OPENAI_MODEL, OPENAI_TTS_MODEL и т.п.
  - TELEGRAM_BOT_TOKEN, TELEGRAM_CHAT_ID, TELEGRAM_NEWS_CHAT_ID[_RU|_DE]
  - SENDGRID_API_KEY
  - NEWS_CRON_SECRET (для защищённого запуска news-cron.js)

Папка src/
----------
src/main.tsx
- Точка входа фронтенда:
  - подключает React, роутер, глобальные стили.
  - рендерит корневой компонент (обычно <App /> или аналог).

src/App.tsx (или аналогичный корневой компонент)
- Описывает общую “рамку” сайта:
  - верхнее меню (Главная / Наше видение / Устав / Манифест / Форум / Присоединиться / и т.д.),
  - переключатель языков,
  - маршрутизацию по страницам.

src/pages/
- Home / Landing (главная)       — философский экран с андроидом, кнопкой “Войти в сознание” и кратким описанием NovaCiv.
- Manifest*.tsx                  — страницы манифеста (на разных языках).
- Charter*.tsx                   — страницы устава (на разных языках).
- Join.tsx                       — страница “Присоединиться” (счётчики, кнопки “Присоединяюсь / Мне нравится” и т.п.).
- ForumPage.tsx                  — интерфейс форума: разделы, темы, ответы.
- News.tsx                       — Лента движения NovaCiv (список новостей/тем из форума, фильтрация по языкам).
- Дополнительные страницы        — Drivers.tsx (для MobilTruck), info-страницы, служебные экраны.

src/components/
- Общие визуальные компоненты:
  - шапка/меню, футер;
  - карточки текста;
  - переключатель языков;
  - блоки оформления (андроид-барельеф и прочее).

src/lib/
- Вспомогательные модули и “мозги” фронтенда:
  - firebase.ts / api.ts       — инициализация Firebase, функции работы с форумом и лентой новостей.
  - i18n.ts / translations.ts  — словари переводов и логика выбора языка (в т.ч. авто-детект по браузеру).
  - domovoy.ts                 — клиентская часть логики ИИ-домового (обращения к Netlify-функции ai-domovoy.js).
  - helpers.ts / utils.ts      — небольшие вспомогательные функции (форматирование дат, работа с URL и т.п.).
  - любые новые служебные файлы — стоит кратко описывать здесь при добавлении.

Папка styles/ или глобальные стили
----------------------------------
- tailwind.css / index.css / globals.css
- Настройки Tailwind / кастомные классы / базовая типографика.

Как пользоваться этой картой
----------------------------
1. Перед изменениями архитектуры или добавлением новых файлов:
   - пробегаемся глазами по этому файлу, чтобы вспомнить, что уже есть.
2. После добавления новых страниц, функций или важных модулей:
   - добавляем сюда 1–3 строки описания, **по тому же стилю**.
3. При следующем заходе в проект:
   - сначала смотрим FILE_MAP_NovaCiv.txt, потом уже открываем нужные файлы.

Если в будущем структура заметно изменится (например, вынесем форум в отдельный пакет или добавим ещё 5–10 Netlify-функций), имеет смысл сделать короткую “версию 2” карты, не стирая старую историю, а пометив её как устаревшую.
